{"version":3,"sources":["webpack://effectgraph/./src/llexec/DevExec.vue?c2c5","webpack://effectgraph/./src/llexec/SandBox.vue?0ec0","webpack://effectgraph/./src/llexec/GraphNode.vue?3c2e","webpack://effectgraph/./src/llexec/vue-compile.js","webpack://effectgraph/src/llexec/GraphNode.vue","webpack://effectgraph/./src/llexec/GraphNode.vue?f615","webpack://effectgraph/./src/llexec/GraphNode.vue","webpack://effectgraph/src/llexec/SandBox.vue","webpack://effectgraph/./src/llexec/SandBox.vue?88b7","webpack://effectgraph/./src/llexec/SandBox.vue","webpack://effectgraph/src/llexec/DevExec.vue","webpack://effectgraph/./src/llexec/DevExec.vue?841c","webpack://effectgraph/./src/llexec/DevExec.vue","webpack://effectgraph/./src/llexec/SandBox.vue?ee2b","webpack://effectgraph/./src/llexec/SandBox.vue?b48b","webpack://effectgraph/./src/llexec/SandBox.vue?c7c6"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","water","_e","staticRenderFns","SandBoxvue_type_template_id_2966bd45_scoped_true_render","activeNodes","_l","node","key","_id","execStack","nodeMap","nodes","SandBoxvue_type_template_id_2966bd45_scoped_true_staticRenderFns","GraphNodevue_type_template_id_dc330936_render","compo","ref","tag","parentNode","parentComponent","to","isRootNode","components","on","exec","onExec","ready","onReady","remove","onRemove","GraphNodevue_type_template_id_dc330936_staticRenderFns","getTagContent","str","start","end","indexOf","slice","length","getCompoInfo","compoStr","output","trim","template","script","style","scoped","styleScoped","compile","_ref2","Object","asyncToGenerator","regeneratorRuntime","mark","_callee","_ref","src","noCSS","_ref$library","library","info","scopeID","css","code","runner","result","wrap","_context","prev","next","Math","ceil","random","toString","JSON","stringify","replace","concat","window","THREE","loadJS","filter","f","url","map","lib","Function","Vue","abrupt","stop","_x","apply","arguments","addDeps","_ref3","vue","_ref3$dep","dep","objectSpread","Cache","makeCompo","_ref5","_callee2","_ref4","_ref4$library","vueComp","_context2","sent","_x2","GraphNodevue_type_script_lang_js_","props","default","data","_this","find","n","self","rAFID","execFnc","beforeDestroy","created","methods","v","compos","_this2","tt","setInterval","me","parent","clearInterval","$emit","child","$refs","getCompos","_getCompos","temp","_this3","requestIdleCallback","$forceUpdate","init","mounted","llexec_GraphNodevue_type_script_lang_js_","component","componentNormalizer","GraphNode","SandBoxvue_type_script_lang_js_","computed","a","trashed","watch","addEventListener","omg","console","log","rAF","requestAnimationFrame","fn","cancelAnimationFrame","llexec_SandBoxvue_type_script_lang_js_","SandBox_component","SandBox","DevExecvue_type_script_lang_js_","postMessage","_postMessage","evt","location","origin","tryGet","undefined","Promise","resolve","llexec_DevExecvue_type_script_lang_js_","DevExec_component","__webpack_exports__","_node_modules_vue_style_loader_index_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_SandBox_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_vue_style_loader_index_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_6_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_SandBox_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0___default","exports","module","push","i","content","locals","add","sourceMap","shadowMode"],"mappings":"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","file":"effectgraph.umd.min.2.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"full\"},[(_vm.water)?_c('SandBox',{attrs:{\"water\":_vm.water}}):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.activeNodes && _vm.water)?_c('div',{staticClass:\"app-entry-dom\"},_vm._l((_vm.activeNodes),function(node){return _c('GraphNode',{key:node._id,attrs:{\"execStack\":_vm.execStack,\"nodeMap\":_vm.nodeMap,\"nodes\":_vm.activeNodes,\"node\":node}})}),1):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.compo && _vm.node)?_c(_vm.compo,{ref:\"me\",tag:\"Component\",attrs:{\"parentNode\":_vm.parentNode,\"parentComponent\":_vm.nodeMap[_vm.node.to],\"isRootNode\":!!!_vm.node.to,\"components\":_vm.nodeMap,\"nodes\":_vm.nodes,\"node\":_vm.node},on:{\"exec\":_vm.onExec,\"ready\":_vm.onReady,\"remove\":_vm.onRemove}}):_vm._e()}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","// // npm i @babel/standalone@7.0.0-beta.32 babel-plugin-transform-object-rest-spread babel-plugin-transform-es2015-modules-umd --save\n// import * as Babel from '@babel/standalone/babel.js'\n\n// var dynamicSpread = require('babel-plugin-transform-object-rest-spread')\n// Babel.registerPlugin('transform-object-rest-spread', dynamicSpread)\n\n// // var umd = require('babel-plugin-transform-es2015-modules-umd')\n// // Babel.registerPlugin('transform-es2015-modules-umd', umd)\n\n// // var es6 = [\n// //   [ 'transform-object-rest-spread', { 'useBuiltIns': true } ],\n// //   [\n// //     'transform-es2015-modules-umd',\n// //     {\n// //       exactGlobals: true\n// //     }\n// //   ]\n// // ]\n// var es6 = [\n//   [ 'transform-object-rest-spread', { 'useBuiltIns': true } ]\n//   // [\n//   //   'transform-es2015-modules-umd',\n//   //   {\n//   //     exactGlobals: true\n//   //   }\n//   // ]\n// ]\nimport Vue from 'vue'\nimport * as THREE from 'three'\nimport loadJS from 'load-js'\n\nfunction getTagContent (str, start, end) {\n  if (str.indexOf(start) === -1) {\n    return false\n  }\n  return str.slice(str.indexOf(start) + start.length, str.indexOf(end))\n}\n\nconst getCompoInfo = (compoStr) => {\n  var output = {}\n  compoStr = compoStr.trim()\n  output.template = getTagContent(compoStr, '<template>', '</template>') || ''\n  output.script = getTagContent(compoStr, '<script>', '</script>') || ''\n  output.style = getTagContent(compoStr, '<style>', '</style>') || getTagContent(compoStr, '<style scoped>', '</style>')\n\n  var scoped = !!getTagContent(compoStr, '<style scoped>', '</style>')\n  output.styleScoped = scoped\n  return output\n}\n\nexport const compile = async ({ src, noCSS, library = [] }) => {\n  let info = getCompoInfo(src)\n  var scopeID = ' data-s-' + (Math.ceil(Math.random() * 100000)).toString(36)\n  let css = JSON.stringify(info.style)\n  info.template = info.template.replace('>', `${scopeID}>`)\n\n  if (noCSS) {\n    css = JSON.stringify('')\n  }\n\n  /* eslint-disable */\n\n  let code = `\n    var css = ${css};\n    var head = document.head || document.getElementsByTagName('head')[0];\n    var style = document.createElement('style');\n    style.type = 'text/css';\n    if (style.styleSheet) {\n      style.styleSheet.cssText = css;\n    } else {\n      style.appendChild(document.createTextNode(css));\n    }\n\n    function addScope (styleElt, scopeName) {\n\n      function process() {\n\n        var sheet = styleElt.sheet;\n        var rules = sheet.cssRules;\n        for ( var i = 0; i < rules.length; ++i ) {\n          let rule = rules[i];\n\n          if ( rule.type === 4 ) {\n\n            // console.log(rule)\n            for ( var j = 0; j < rule.cssRules.length; ++j ) {\n\n              let scopedSelectors = [];\n              let subRule = rule.cssRules[j];\n\n              subRule.selectorText.split(/\\s*,\\s*/).forEach(function(sel) {\n\n                scopedSelectors.push(scopeName+' '+sel);\n                let segments = sel.match(/([^ :]+)(.+)?/);\n                scopedSelectors.push(segments[1] + scopeName + (segments[2]||''));\n              });\n\n              let scopedRule = scopedSelectors.join(',') + subRule.cssText.substr(subRule.selectorText.length);\n\n              rule.deleteRule(j);\n              rule.insertRule(scopedRule, j);\n              // console.log(rule);\n            }\n\n            continue;\n          }\n\n          if ( rule.type !== 1 )\n            continue;\n\n          let scopedSelectors = [];\n\n          rule.selectorText.split(/\\s*,\\s*/).forEach(function(sel) {\n\n            scopedSelectors.push(scopeName+' '+sel);\n            let segments = sel.match(/([^ :]+)(.+)?/);\n            scopedSelectors.push(segments[1] + scopeName + (segments[2]||''));\n          });\n\n          let scopedRule = scopedSelectors.join(',') + rule.cssText.substr(rule.selectorText.length);\n          sheet.deleteRule(i);\n          sheet.insertRule(scopedRule, i);\n        }\n      }\n\n      try {\n        // firefox may fail sheet.cssRules with InvalidAccessError\n        process();\n      } catch (ex) {\n\n        if ( ex instanceof DOMException && ex.code === DOMException.INVALID_ACCESS_ERR ) {\n\n          styleElt.sheet.disabled = true;\n          styleElt.addEventListener('load', function onStyleLoaded() {\n\n            styleElt.removeEventListener('load', onStyleLoaded);\n\n            // firefox need this timeout otherwise we have to use document.importNode(style, true)\n            setTimeout(function() {\n\n              process();\n              styleElt.sheet.disabled = false;\n            });\n          });\n          return;\n        }\n\n        throw ex;\n      }\n    }\n\n    head.appendChild(style);\n    if (${info.styleScoped}) {\n      addScope(style, '[${scopeID}]');\n    }\n  `\n\n  /* eslint-enable */\n\n  // inject template property into the export Object\n  info.script = `var mycompo = { template: '<div></div>' };` + info.script\n  info.script = info.script.replace('export default {', `mycompo = { \\n\\ttemplate: ${JSON.stringify(info.template)},`)\n\n  let end = `\n    return mycompo;\n  `\n  // console.log(info)\n  let output = code + info.script + end\n\n  window.THREE = THREE\n\n  // console.log(library)\n\n  await loadJS(library.filter(f => f.url).map((lib) => {\n    return {\n      url: lib.url\n    }\n  }))\n\n  /* eslint-disable */\n  let runner = new Function('Vue', 'THREE', 'window', output)\n  /* eslint-enable */\n\n  let result = runner(Vue, THREE, window)\n\n  // console.log(result)\n  return result\n}\n\nexport const addDeps = ({ vue, dep = {} }) => {\n  vue.components = {\n    ...vue.components,\n    ...dep\n  }\n  return vue\n}\n\nexport const Cache = {}\n\nexport const makeCompo = async ({ src, library = [] }) => {\n  if (Cache[src]) {\n    return Cache[src]\n  } else {\n    let vueComp = await compile({\n      src,\n      noCSS: false,\n      library\n    })\n    vueComp = addDeps({\n      vue: vueComp,\n      dep: {\n        // Object3D: require('../vfx/FreeJS/Object3D.vue').default\n      }\n    })\n    Cache[src] = vueComp\n    return vueComp\n  }\n}\n","<template>\n  <Component v-if=\"compo && node\" @exec=\"onExec\" :parentNode=\"parentNode\" ref=\"me\" :parentComponent=\"nodeMap[node.to]\" :isRootNode=\"!!!node.to\" :components=\"nodeMap\" :nodes=\"nodes\" :node=\"node\" @ready=\"onReady\" @remove=\"onRemove\" :is=\"compo\"></Component>\n</template>\n\n<script>\nimport * as VC from './vue-compile'\nexport default {\n  props: {\n    node: {},\n    nodes: {},\n    nodeMap: {},\n    execStack: {\n      default () {\n        return {}\n      }\n    }\n  },\n  data () {\n    return {\n      parentNode: this.nodes.find(n => n._id === this.node.to),\n      compo: false,\n      self: {},\n      rAFID: 0,\n      execFnc () {\n      }\n    }\n  },\n  beforeDestroy () {\n    this.execStack[this.node._id] = false\n    // window.cancelAnimationFrame(this.rAFID)\n  },\n  created () {\n    // let rAF = () => {\n    //   this.rAFID = window.requestAnimationFrame(rAF)\n    //   this.execFnc()\n    // }\n    // this.rAFID = window.requestAnimationFrame(rAF)\n  },\n  methods: {\n    onExec (v) {\n      this.execStack[this.node._id] = v\n    },\n    onReady (compos) {\n      let tt = setInterval(() => {\n        let me = this.nodeMap[this.node._id] = compos\n        let parent = this.nodeMap[this.node.to]\n        if (parent) {\n          clearInterval(tt)\n          // me.$emit('addToParent', {\n          //   parent,\n          //   me\n          // })\n          parent.$emit('addChild', {\n            child: me,\n            me: parent\n          })\n        }\n      }, 1)\n    },\n    onRemove () {\n      let me = this.$refs['me']\n      let parent = this.nodeMap[this.node.to]\n      // if (this.nodeMap[this.node._id]) {\n      //   this.nodeMap[this.node._id].$emit('removeFromParent', {\n      //     me: me,\n      //     parent: parent\n      //   })\n      // }\n      if (this.node.to) {\n        this.nodeMap[this.node.to].$emit('removeChild', {\n          me: parent,\n          child: me\n        })\n      }\n    },\n    async getCompos ({ node }) {\n      let temp = `\n        <template>\n          <div class=\"omg-this-compo\" nodeid=\"${node._id}\"></div>\n        </template>\n        <script>\n        export default {\n        };\n        ${'<'}/script>\n        <style>\n        </style>\n      `\n      window.requestIdleCallback(async () => {\n        this.compo = await VC.makeCompo({ src: node.src || temp, library: node.library || [] })\n        this.$forceUpdate()\n      })\n    },\n    init () {\n\n    }\n  },\n  mounted () {\n    this.getCompos({ node: this.node })\n  }\n}\n</script>\n\n<style>\n\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GraphNode.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./GraphNode.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./GraphNode.vue?vue&type=template&id=dc330936&\"\nimport script from \"./GraphNode.vue?vue&type=script&lang=js&\"\nexport * from \"./GraphNode.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"app-entry-dom\" v-if=\"activeNodes && water\">\n    <GraphNode :execStack=\"execStack\" :nodeMap=\"nodeMap\" :nodes=\"activeNodes\" :node=\"node\" :key=\"node._id\" v-for=\"node in activeNodes\"></GraphNode>\n  </div>\n</template>\n\n<script>\nimport GraphNode from './GraphNode.vue'\n// import * as Node from '../llsvg/node.js'\nexport default {\n  components: {\n    GraphNode\n  },\n  props: {\n    water: {}\n  },\n  computed: {\n    nodes () {\n      return this.water.nodes\n    },\n    activeNodes () {\n      return this.nodes.filter(a => !a.trashed).slice()\n    }\n  },\n  watch: {\n    water () {\n    }\n  },\n  data () {\n    return {\n      execStack: {},\n      nodeMap: {}\n    }\n  },\n  mounted () {\n    window.addEventListener('message', (omg) => {\n      console.log(omg)\n    })\n\n    let rAF = () => {\n      this.rAFID = window.requestAnimationFrame(rAF)\n      for (var key in this.execStack) {\n        let fn = this.execStack[key]\n        if (fn) {\n          fn()\n        }\n      }\n    }\n    this.rAFID = window.requestAnimationFrame(rAF)\n  },\n  beforeDestroy () {\n    cancelAnimationFrame(this.rAFID)\n  },\n  methods: {\n  }\n}\n</script>\n\n<style>\nbody, html, .app-entry-dom, .full{\n  width: 100%;\n  height: 100%;\n}\nhtml{\n  overflow: hidden;\n}\nbody{\n  margin: 0px;\n}\n.app-entry-dom {\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  color: #2c3e50;\n\n  overflow: scroll;\n  -webkit-overflow-scrolling: touch;\n}\n</style>\n\n<style scoped>\n\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SandBox.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SandBox.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SandBox.vue?vue&type=template&id=2966bd45&scoped=true&\"\nimport script from \"./SandBox.vue?vue&type=script&lang=js&\"\nexport * from \"./SandBox.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SandBox.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2966bd45\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"full\">\n    <SandBox v-if=\"water\" :water=\"water\"></SandBox>\n  </div>\n</template>\n\n<script>\nimport SandBox from './SandBox.vue'\n\nexport default {\n  props: {\n    nodes: {}\n  },\n  components: {\n    SandBox\n  },\n  data () {\n    return {\n      water: {\n        nodes: this.nodes\n      }\n    }\n  },\n  methods: {\n    async postMessage (evt) {\n      window.postMessage(evt, window.location.origin)\n    },\n    tryGet (fn = () => {}) {\n      return new Promise((resolve) => {\n        let tt = setInterval(() => {\n          let result = fn()\n          if (result) {\n            clearInterval(tt)\n            resolve(result)\n          }\n        }, 0)\n      })\n    }\n  },\n  watch: {\n    nodes () {\n      this.water.nodes = this.nodes\n    }\n  }\n}\n</script>\n\n<style>\n\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DevExec.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./DevExec.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./DevExec.vue?vue&type=template&id=ffeb8356&\"\nimport script from \"./DevExec.vue?vue&type=script&lang=js&\"\nexport * from \"./DevExec.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/vue-style-loader/index.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SandBox.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/vue-style-loader/index.js??ref--6-oneOf-1-0!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SandBox.vue?vue&type=style&index=0&lang=css&\"","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".app-entry-dom,.full,body,html{width:100%;height:100%}html{overflow:hidden}body{margin:0}.app-entry-dom{font-family:Avenir,Helvetica,Arial,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;color:#2c3e50;overflow:scroll;-webkit-overflow-scrolling:touch}\", \"\"]);\n\n// exports\n","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SandBox.vue?vue&type=style&index=0&lang=css&\");\nif(typeof content === 'string') content = [[module.id, content, '']];\nif(content.locals) module.exports = content.locals;\n// add the styles to the DOM\nvar add = require(\"!../../node_modules/vue-style-loader/lib/addStylesClient.js\").default\nvar update = add(\"d841d61c\", content, true, {\"sourceMap\":false,\"shadowMode\":false});"],"sourceRoot":""}