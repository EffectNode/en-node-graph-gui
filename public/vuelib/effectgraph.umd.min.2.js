(("undefined"!==typeof self?self:this)["webpackJsonpeffectgraph"]=("undefined"!==typeof self?self:this)["webpackJsonpeffectgraph"]||[]).push([[2],{"65c2":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"full"},[e.water?n("SandBox",{attrs:{water:e.water}}):e._e()],1)},r=[],s=(n("551c"),n("96cf"),n("3b8d")),c=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.activeNodes&&e.water?n("div",{staticClass:"app-entry-dom"},e._l(e.activeNodes,function(t){return n("GraphNode",{key:t._id,attrs:{execStack:e.execStack,nodeMap:e.nodeMap,nodes:e.activeNodes,node:t}})}),1):e._e()},a=[],i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.compo&&e.node?n(e.compo,{ref:"me",tag:"Component",attrs:{parentNode:e.parentNode,parentComponent:e.nodeMap[e.node.to],isRootNode:!e.node.to,components:e.nodeMap,nodes:e.nodes,node:e.node},on:{exec:e.onExec,ready:e.onReady,remove:e.onRemove}}):e._e()},l=[],u=(n("7514"),n("cebc")),d=(n("a481"),n("6b54"),n("8bbf")),p=n.n(d),f=n("5a89"),m=n("2100"),h=n.n(m);function v(e,t,n){return-1!==e.indexOf(t)&&e.slice(e.indexOf(t)+t.length,e.indexOf(n))}var y=function(e){var t={};e=e.trim(),t.template=v(e,"<template>","</template>")||"",t.script=v(e,"<script>","<\/script>")||"",t.style=v(e,"<style>","</style>")||v(e,"<style scoped>","</style>");var n=!!v(e,"<style scoped>","</style>");return t.styleScoped=n,t},w=function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t){var n,o,r,s,c,a,i,l,u,d,m,v;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n=t.src,o=t.noCSS,r=t.library,s=void 0===r?[]:r,c=y(n),a=" data-s-"+Math.ceil(1e5*Math.random()).toString(36),i=JSON.stringify(c.style),c.template=c.template.replace(">","".concat(a,">")),o&&(i=JSON.stringify("")),l="\n    var css = ".concat(i,";\n    var head = document.head || document.getElementsByTagName('head')[0];\n    var style = document.createElement('style');\n    style.type = 'text/css';\n    if (style.styleSheet) {\n      style.styleSheet.cssText = css;\n    } else {\n      style.appendChild(document.createTextNode(css));\n    }\n\n    function addScope (styleElt, scopeName) {\n\n      function process() {\n\n        var sheet = styleElt.sheet;\n        var rules = sheet.cssRules;\n        for ( var i = 0; i < rules.length; ++i ) {\n          let rule = rules[i];\n\n          if ( rule.type === 4 ) {\n\n            // console.log(rule)\n            for ( var j = 0; j < rule.cssRules.length; ++j ) {\n\n              let scopedSelectors = [];\n              let subRule = rule.cssRules[j];\n\n              subRule.selectorText.split(/s*,s*/).forEach(function(sel) {\n\n                scopedSelectors.push(scopeName+' '+sel);\n                let segments = sel.match(/([^ :]+)(.+)?/);\n                scopedSelectors.push(segments[1] + scopeName + (segments[2]||''));\n              });\n\n              let scopedRule = scopedSelectors.join(',') + subRule.cssText.substr(subRule.selectorText.length);\n\n              rule.deleteRule(j);\n              rule.insertRule(scopedRule, j);\n              // console.log(rule);\n            }\n\n            continue;\n          }\n\n          if ( rule.type !== 1 )\n            continue;\n\n          let scopedSelectors = [];\n\n          rule.selectorText.split(/s*,s*/).forEach(function(sel) {\n\n            scopedSelectors.push(scopeName+' '+sel);\n            let segments = sel.match(/([^ :]+)(.+)?/);\n            scopedSelectors.push(segments[1] + scopeName + (segments[2]||''));\n          });\n\n          let scopedRule = scopedSelectors.join(',') + rule.cssText.substr(rule.selectorText.length);\n          sheet.deleteRule(i);\n          sheet.insertRule(scopedRule, i);\n        }\n      }\n\n      try {\n        // firefox may fail sheet.cssRules with InvalidAccessError\n        process();\n      } catch (ex) {\n\n        if ( ex instanceof DOMException && ex.code === DOMException.INVALID_ACCESS_ERR ) {\n\n          styleElt.sheet.disabled = true;\n          styleElt.addEventListener('load', function onStyleLoaded() {\n\n            styleElt.removeEventListener('load', onStyleLoaded);\n\n            // firefox need this timeout otherwise we have to use document.importNode(style, true)\n            setTimeout(function() {\n\n              process();\n              styleElt.sheet.disabled = false;\n            });\n          });\n          return;\n        }\n\n        throw ex;\n      }\n    }\n\n    head.appendChild(style);\n    if (").concat(c.styleScoped,") {\n      addScope(style, '[").concat(a,"]');\n    }\n  "),c.script="var mycompo = { template: '<div></div>' };"+c.script,c.script=c.script.replace("export default {","mycompo = { \n\ttemplate: ".concat(JSON.stringify(c.template),",")),u="\n    return mycompo;\n  ",d=l+c.script+u,window.THREE=f,e.next=14,h()(s.filter(function(e){return e.url}).map(function(e){return{url:e.url}}));case 14:return m=new Function("Vue","THREE","window",d),v=m(p.a,f,window),e.abrupt("return",v);case 17:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),x=function(e){var t=e.vue,n=e.dep,o=void 0===n?{}:n;return t.components=Object(u["a"])({},t.components,o),t},g={},b=function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t){var n,o,r,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.src,o=t.library,r=void 0===o?[]:o,!g[n]){e.next=5;break}return e.abrupt("return",g[n]);case 5:return e.next=7,w({src:n,noCSS:!1,library:r});case 7:return s=e.sent,s=x({vue:s,dep:{}}),g[n]=s,e.abrupt("return",s);case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),S={props:{node:{},nodes:{},nodeMap:{},execStack:{default:function(){return{}}}},data:function(){var e=this;return{parentNode:this.nodes.find(function(t){return t._id===e.node.to}),compo:!1,self:{},rAFID:0,execFnc:function(){}}},beforeDestroy:function(){this.execStack[this.node._id]=!1},created:function(){},methods:{onExec:function(e){this.execStack[this.node._id]=e},onReady:function(e){var t=this,n=setInterval(function(){var o=t.nodeMap[t.node._id]=e,r=t.nodeMap[t.node.to];r&&(clearInterval(n),o.$emit("addToParent",{parent:r,me:o}),r.$emit("addChild",{child:o,me:r}))},1)},onRemove:function(){var e=this.$refs["me"],t=this.nodeMap[this.node.to];this.nodeMap[this.node._id]&&this.nodeMap[this.node._id].$emit("removeFromParent",{me:e,parent:t}),this.node.to&&this.nodeMap[this.node.to].$emit("removeChild",{me:t,child:e})},getCompos:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t){var n,o,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n=t.node,o='\n        <template>\n          <div class="omg-this-compo" nodeid="'.concat(n._id,'"></div>\n        </template>\n        <script>\n        export default {\n        };\n        ',"<","/script>\n        <style>\n        </style>\n      "),window.requestIdleCallback(Object(s["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,b({src:n.src||o,library:n.library||[]});case 2:r.compo=e.sent,r.$forceUpdate();case 4:case"end":return e.stop()}},e)})));case 3:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}(),init:function(){}},mounted:function(){this.getCompos({node:this.node})}},R=S,E=n("2877"),N=Object(E["a"])(R,i,l,!1,null,null,null),k=N.exports,_={components:{GraphNode:k},props:{water:{}},computed:{nodes:function(){return this.water.nodes},activeNodes:function(){return this.nodes.filter(function(e){return!e.trashed}).slice()}},watch:{water:function(){}},data:function(){return{execStack:{},nodeMap:{}}},mounted:function(){var e=this,t=function t(){for(var n in e.rAFID=window.requestAnimationFrame(t),e.execStack){var o=e.execStack[n];o&&o()}};this.rAFID=window.requestAnimationFrame(t)},beforeDestroy:function(){cancelAnimationFrame(this.rAFID)},methods:{}},M=_,j=(n("923e"),Object(E["a"])(M,c,a,!1,null,"3d83fe4e",null)),O=j.exports,C={props:{nodes:{}},components:{SandBox:O},data:function(){return{water:{nodes:this.nodes}}},methods:{postMessage:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:console.log(t);case 1:case"end":return e.stop()}},e)}));function t(t){return e.apply(this,arguments)}return t}(),tryGet:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};return new Promise(function(t){var n=setInterval(function(){var o=e();o&&(clearInterval(n),t(o))},0)})}},watch:{nodes:function(){this.water.nodes=this.nodes}}},T=C,A=Object(E["a"])(T,o,r,!1,null,null,null);t["default"]=A.exports},"923e":function(e,t,n){"use strict";var o=n("d47b"),r=n.n(o);r.a},bd71:function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,".app-entry-dom,.full,body,html{width:100%;height:100%}html{overflow:hidden}body{margin:0}.app-entry-dom{font-family:Avenir,Helvetica,Arial,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;color:#2c3e50;overflow:scroll;-webkit-overflow-scrolling:touch}",""])},d47b:function(e,t,n){var o=n("bd71");"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var r=n("499e").default;r("d841d61c",o,!0,{sourceMap:!1,shadowMode:!1})}}]);
//# sourceMappingURL=effectgraph.umd.min.2.js.map